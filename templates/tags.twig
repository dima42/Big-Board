{% extends 'loggedin.twig' %}

{% block filters %}
{% for scope_title, scope_tags in scopes %}
    <h4 class="nav-header">{{ scope_title }}</h4>
    <ul class="nav nav-pills flex-column">
        {% for tag in scope_tags if tag.level > 0 %}
        <li class="nav-item">
            <a class="nav-link" href="/tags/admin">{{ tag.title }}</a>
        </li>
        {% endfor %}
    </ul>
{% endfor %}
{% endblock %}

{% block content %}
<h1>Tags</h1>
{% endblock %}

{% block scripts %}
<script>
$(function() {
    $('[data-behavior=add-tag]').click(function(e) {
        e.preventDefault();
        var parent = $(this).closest('.tag');
        $.get('/templates/add_tag.mst', function(template) {
            var rendered = Mustache.render(template, {
                'parent': parent.data('pk'),
                'level': parent.data('level') + 1
            });
            parent.after(rendered);
            parent.next().find('input').first().focus();
        });
    });
});
</script>
{% endblock %}
